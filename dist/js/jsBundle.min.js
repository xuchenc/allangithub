!function(){"use strict";function t(t,e,o){t.state("Home",{url:"/",templateUrl:"views/Home.html"}).state("Login_Register",{url:"/login-register",templateUrl:"views/login_register.html"}).state("CreatePost",{url:"/create",templateUrl:"views/create.html"}).state("MovieList",{url:"/movielist",templateUrl:"views/movieList.html"}).state("EditPost",{url:"/editpost/:id",templateUrl:"views/editPost.html"}).state("PostDetails",{url:"/post/:id",templateUrl:"views/postDetails.html"}),e.otherwise("/"),o.interceptors.push("AuthInterceptor")}angular.module("app",["ui.router"]).config(t),t.$inject=["$stateProvider","$urlRouterProvider","$httpProvider"]}(),function(){"use strict";function t(t,e){var o=this;o.post={},o.createPost=function(){t.createPost(o.post).then(function(){e.go("MovieList")})}}angular.module("app").controller("CreateController",t),t.$inject=["HomeFactory","$state"]}(),function(){"use strict";function t(t,e){var o=this;o.post={},o.editPost=function(){t.editPost(o.edittedPost).then(function(t){})}}angular.module("app").controller("EditController",t),t.$inject=["HomeFactory","$state"]}(),function(){"use strict";function t(t,e){var o=this;o.user={},o.isLogin=!0,o.status=t.status,o.logout=function(){t.logout()},o.register=function(){t.register(o.user).then(function(){e.go("Home")})},o.login=function(){t.login(o.user).then(function(){e.go("Home")})}}angular.module("app").controller("GlobalController",t),t.$inject=["UserFactory","$state"]}(),function(){"use strict";function t(t){var e=this;e.edittedPost={},t.getAllMovie().then(function(t){e.posts=t}),e.deletePost=function(o){t.deletePost(o._id).then(function(){e.posts.splice(e.posts.indexOf(o),1)})},e.editPost=function(o){t.editPost({IDofpostToEdit:o,postEditted:e.edittedPost}).then(function(o){console.log("Made it back"),console.log(o),e.edittedPost=null,t.getAllMovie().then(function(t){e.posts=t})})}}angular.module("app").controller("HomeController",t),t.$inject=["HomeFactory"]}(),function(){"use strict";function t(t,e,o){var n=this;n.comment={},o.id&&t.getMovieById(o.id).then(function(t){n.movie=t}),n.addComment=function(){t.createComment(n.comment,o.id).then(function(t){})}}angular.module("app").controller("PostDetailsController",t),t.$inject=["HomeFactory","$state","$stateParams"]}(),function(){"use strict";function t(t){var e={request:function(e){return t.localStorage.getItem("token")&&(e.headers.authorization="Bearer "+t.localStorage.getItem("token")),e}};return e}angular.module("app").factory("AuthInterceptor",t),t.$inject=["$window"]}(),function(){"use strict";function t(t,e){var o={};return o.getAllMovie=function(){var o=e.defer();return t.get("/api/movie").then(function(t){o.resolve(t.data)}),o.promise},o.editPost=function(o){var n=e.defer();return t.put("/api/movie",o).then(function(t){n.resolve(t.data)}),n.promise},o.deletePost=function(o){var n=e.defer();return t["delete"]("/api/movie/"+o).then(function(){n.resolve()}),n.promise},o.getMovieById=function(o){var n=e.defer();return t.get("/api/movie/"+o).then(function(t){n.resolve(t.data)}),n.promise},o.createComment=function(o,n){var r=e.defer();return t.post("/api/movie/"+n+"/comment",o).then(function(t){r.resolve(t.data)}),r.promise},o.createPost=function(o){var n=e.defer();return t.post("/api/movie",o).then(function(){n.resolve()}),n.promise},o}angular.module("app").factory("HomeFactory",t),t.$inject=["$http","$q"]}(),function(){"use strict";function t(t,e){function o(){var t=JSON.parse(a(r().split(".")[1]));u.status.username=t.username,u.status._id=t._id}function n(){u.status.username=null,u.status._id=null}function r(){return localStorage.getItem("token")}function i(t){return localStorage.setItem("token",t)}function s(){return localStorage.removeItem("token")}function a(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}return decodeURIComponent(escape(window.atob(e)))}var u={};return u.status={},u.register=function(n){var r=e.defer();return t.post("/api/users/register",n).then(function(t){console.log(t.data),i(t.data),o(),r.resolve(t.data)}),r.promise},u.login=function(n){var r=e.defer();return t.post("/api/users/login",n).then(function(t){i(t.data),o(),r.resolve(t.data)}),r.promise},u.logout=function(){s(),n()},r()&&o(),u}angular.module("app").factory("UserFactory",t),t.$inject=["$http","$q"]}();